## DataFrames

### Spark XML

```
import org.apache.spark.sql.SQLContext
import com.databricks.spark.xml._

val sqlContext = new SQLContext(sc)
val experiment = sqlContext.read
  .format("com.databricks.spark.xml")
  .option("rowTag", "EXPERIMENT")
  .load("s3n://omics_metadata/sra/reports/Mirroring/NCBI_SRA_Mirroring_20171213_Full/meta_experiment_set.xml.gz")
```

```
experiment.printSchema
```

```
root
 |-- DESIGN: struct (nullable = true)
 |    |-- DESIGN_DESCRIPTION: string (nullable = true)
 |    |-- LIBRARY_DESCRIPTOR: struct (nullable = true)
 |    |    |-- LIBRARY_CONSTRUCTION_PROTOCOL: string (nullable = true)
 |    |    |-- LIBRARY_LAYOUT: struct (nullable = true)
 |    |    |    |-- PAIRED: struct (nullable = true)
 |    |    |    |    |-- _NOMINAL_LENGTH: long (nullable = true)
 |    |    |    |    |-- _NOMINAL_SDEV: double (nullable = true)
 |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |-- SINGLE: string (nullable = true)
 |    |    |-- LIBRARY_NAME: string (nullable = true)
 |    |    |-- LIBRARY_SELECTION: string (nullable = true)
 |    |    |-- LIBRARY_SOURCE: string (nullable = true)
 |    |    |-- LIBRARY_STRATEGY: string (nullable = true)
 |    |    |-- TARGETED_LOCI: struct (nullable = true)
 |    |    |    |-- LOCUS: array (nullable = true)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- PROBE_SET: struct (nullable = true)
 |    |    |    |    |    |    |-- DB: string (nullable = true)
 |    |    |    |    |    |    |-- ID: string (nullable = true)
 |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |-- _description: string (nullable = true)
 |    |    |    |    |    |-- _locus_name: string (nullable = true)
 |    |-- SAMPLE_DESCRIPTOR: struct (nullable = true)
 |    |    |-- IDENTIFIERS: struct (nullable = true)
 |    |    |    |-- EXTERNAL_ID: array (nullable = true)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |-- _label: string (nullable = true)
 |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |-- PRIMARY_ID: string (nullable = true)
 |    |    |    |-- SECONDARY_ID: array (nullable = true)
 |    |    |    |    |-- element: string (containsNull = true)
 |    |    |    |-- SUBMITTER_ID: array (nullable = true)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |-- UUID: string (nullable = true)
 |    |    |-- POOL: struct (nullable = true)
 |    |    |    |-- DEFAULT_MEMBER: struct (nullable = true)
 |    |    |    |    |-- IDENTIFIERS: struct (nullable = true)
 |    |    |    |    |    |-- EXTERNAL_ID: array (nullable = true)
 |    |    |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |    |    |-- PRIMARY_ID: string (nullable = true)
 |    |    |    |    |    |-- SUBMITTER_ID: struct (nullable = true)
 |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |-- MEMBER: array (nullable = true)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- IDENTIFIERS: struct (nullable = true)
 |    |    |    |    |    |    |-- EXTERNAL_ID: array (nullable = true)
 |    |    |    |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |    |    |-- _label: string (nullable = true)
 |    |    |    |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |    |    |    |-- PRIMARY_ID: string (nullable = true)
 |    |    |    |    |    |    |-- SUBMITTER_ID: struct (nullable = true)
 |    |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |    |    |    |-- READ_LABEL: array (nullable = true)
 |    |    |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |    |-- _read_group_tag: string (nullable = true)
 |    |    |    |    |    |-- _accession: string (nullable = true)
 |    |    |    |    |    |-- _member_name: string (nullable = true)
 |    |    |    |    |    |-- _proportion: double (nullable = true)
 |    |    |    |    |    |-- _refcenter: string (nullable = true)
 |    |    |    |    |    |-- _refname: string (nullable = true)
 |    |    |-- _VALUE: string (nullable = true)
 |    |    |-- _accession: string (nullable = true)
 |    |    |-- _refcenter: string (nullable = true)
 |    |    |-- _refname: string (nullable = true)
 |    |-- SPOT_DESCRIPTOR: struct (nullable = true)
 |    |    |-- SPOT_DECODE_SPEC: struct (nullable = true)
 |    |    |    |-- READ_SPEC: array (nullable = true)
 |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |-- BASE_COORD: long (nullable = true)
 |    |    |    |    |    |-- EXPECTED_BASECALL_TABLE: struct (nullable = true)
 |    |    |    |    |    |    |-- BASECALL: array (nullable = true)
 |    |    |    |    |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |    |    |-- _match_edge: string (nullable = true)
 |    |    |    |    |    |    |    |    |-- _max_mismatch: long (nullable = true)
 |    |    |    |    |    |    |    |    |-- _min_match: long (nullable = true)
 |    |    |    |    |    |    |    |    |-- _read_group_tag: string (nullable = true)
 |    |    |    |    |    |    |-- _base_coord: long (nullable = true)
 |    |    |    |    |    |    |-- _default_length: long (nullable = true)
 |    |    |    |    |    |-- READ_CLASS: string (nullable = true)
 |    |    |    |    |    |-- READ_INDEX: long (nullable = true)
 |    |    |    |    |    |-- READ_LABEL: string (nullable = true)
 |    |    |    |    |    |-- READ_TYPE: string (nullable = true)
 |    |    |    |    |    |-- RELATIVE_ORDER: struct (nullable = true)
 |    |    |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |    |    |-- _follows_read_index: long (nullable = true)
 |    |    |    |    |    |    |-- _precedes_read_index: long (nullable = true)
 |    |    |    |-- SPOT_LENGTH: long (nullable = true)
 |    |-- _com: string (nullable = true)
 |-- EXPERIMENT_ATTRIBUTES: struct (nullable = true)
 |    |-- EXPERIMENT_ATTRIBUTE: array (nullable = true)
 |    |    |-- element: struct (containsNull = true)
 |    |    |    |-- TAG: string (nullable = true)
 |    |    |    |-- UNITS: string (nullable = true)
 |    |    |    |-- VALUE: string (nullable = true)
 |    |-- _com: string (nullable = true)
 |-- EXPERIMENT_LINKS: struct (nullable = true)
 |    |-- EXPERIMENT_LINK: array (nullable = true)
 |    |    |-- element: struct (containsNull = true)
 |    |    |    |-- URL_LINK: struct (nullable = true)
 |    |    |    |    |-- LABEL: string (nullable = true)
 |    |    |    |    |-- URL: string (nullable = true)
 |    |    |    |-- XREF_LINK: struct (nullable = true)
 |    |    |    |    |-- DB: string (nullable = true)
 |    |    |    |    |-- ID: string (nullable = true)
 |    |    |    |    |-- LABEL: string (nullable = true)
 |-- IDENTIFIERS: struct (nullable = true)
 |    |-- EXTERNAL_ID: struct (nullable = true)
 |    |    |-- _VALUE: string (nullable = true)
 |    |    |-- _namespace: string (nullable = true)
 |    |-- PRIMARY_ID: string (nullable = true)
 |    |-- SECONDARY_ID: array (nullable = true)
 |    |    |-- element: string (containsNull = true)
 |    |-- SUBMITTER_ID: array (nullable = true)
 |    |    |-- element: struct (containsNull = true)
 |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |-- _label: long (nullable = true)
 |    |    |    |-- _namespace: string (nullable = true)
 |    |-- UUID: string (nullable = true)
 |-- PLATFORM: struct (nullable = true)
 |    |-- ABI_SOLID: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- BGISEQ: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- CAPILLARY: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- COMPLETE_GENOMICS: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- HELICOS: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- ILLUMINA: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |    |-- _com: string (nullable = true)
 |    |-- ION_TORRENT: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |    |-- _com: string (nullable = true)
 |    |-- LS454: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- OXFORD_NANOPORE: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |    |-- PACBIO_SMRT: struct (nullable = true)
 |    |    |-- INSTRUMENT_MODEL: string (nullable = true)
 |-- PROCESSING: string (nullable = true)
 |-- STUDY_REF: struct (nullable = true)
 |    |-- IDENTIFIERS: struct (nullable = true)
 |    |    |-- EXTERNAL_ID: array (nullable = true)
 |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |-- _label: string (nullable = true)
 |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |-- PRIMARY_ID: string (nullable = true)
 |    |    |-- SECONDARY_ID: string (nullable = true)
 |    |    |-- SUBMITTER_ID: array (nullable = true)
 |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |    |-- _label: string (nullable = true)
 |    |    |    |    |-- _namespace: string (nullable = true)
 |    |    |-- UUID: string (nullable = true)
 |    |-- _VALUE: string (nullable = true)
 |    |-- _accession: string (nullable = true)
 |    |-- _refcenter: string (nullable = true)
 |    |-- _refname: string (nullable = true)
 |-- TITLE: string (nullable = true)
 |-- _accession: string (nullable = true)
 |-- _alias: string (nullable = true)
 |-- _broker_name: string (nullable = true)
 |-- _center_name: string (nullable = true)
 |-- _com: string (nullable = true)
 |-- _ns1: string (nullable = true)
 |-- _ns2: string (nullable = true)
 |-- _xmlns: string (nullable = true)
 |-- _xsi: string (nullable = true)
 ```
 
### CSV files

see https://github.com/databricks/spark-csv#scala-api

```
val sqlContext = new SQLContext(sc)
val df = sqlContext.read
    .format("com.databricks.spark.csv")
    .option("header", "true") // Use first line of all files as header
    .option("inferSchema", "true") // Automatically infer data types
    .load("cars.csv")

val selectedData = df.select("year", "model")
selectedData.write
    .format("com.databricks.spark.csv")
    .option("header", "true")
    .save("newcars.csv")
```
